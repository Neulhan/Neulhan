<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Google tag (gtag.js) -->
        <script
            async
            src="https://www.googletagmanager.com/gtag/js?id=G-XJDD8QBH8T"
        ></script>
        <script>
            window.dataLayer = window.dataLayer || []
            function gtag() {
                dataLayer.push(arguments)
            }
            gtag('js', new Date())

            gtag('config', 'G-XJDD8QBH8T')
        </script>

        <meta charset="utf-8" />
        <link rel="icon" href="../favicon.ico" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="preconnect" href="https://cdn.jsdelivr.net" />
        <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
        <link
            href="https://cdn.jsdelivr.net/gh/toss/tossface/dist/tossface.css"
            rel="stylesheet"
            type="text/css"
        />
        <link
            rel="stylesheet"
            as="style"
            crossorigin
            href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css"
        />

        
		<link href="../_app/immutable/assets/0.aa18b1d1.css" rel="stylesheet">
		<link href="../_app/immutable/assets/3.23bda755.css" rel="stylesheet">
		<link rel="modulepreload" href="../_app/immutable/entry/start.21561554.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/scheduler.683807b4.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/singletons.d89be1b9.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/control.f5b05b5f.js">
		<link rel="modulepreload" href="../_app/immutable/entry/app.38abf126.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/preload-helper.a4192956.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/index.949589b5.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/0.1886c134.js">
		<link rel="modulepreload" href="../_app/immutable/chunks/stores.a581fe04.js">
		<link rel="modulepreload" href="../_app/immutable/nodes/3.4d068507.js"><title>django ì¶”ì²œì‹œìŠ¤í…œ ê°€ì¥ ì‰½ê²Œ êµ¬í˜„í•˜ê¸°</title><!-- HEAD_svelte-57aoaq_START --><link rel="canonical" href="https://blog.neulhan.com/django-recommendation-system/"><!-- HEAD_svelte-57aoaq_END --><!-- HEAD_svelte-zl2pue_START --><!-- HTML_TAG_START --><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "NewsArticle",
  "headline": "django ì¶”ì²œì‹œìŠ¤í…œ ê°€ì¥ ì‰½ê²Œ êµ¬í˜„í•˜ê¸°",
  "image": [
    "https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-11-18-00.png.webp"
  ],
  "datePublished": "2024-05-13T09:20:00+09:00",
  "dateModified": "2024-05-13T09:20:00+09:00",
  "author": [
    {
      "@type": "Person",
      "name": "Neulhan",
      "url": "https://blog.neulhan.com/about"
    }
  ]
}</script><!-- HTML_TAG_END --><meta name="description" content="django ì—ì„œ ì¶”ì²œì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”? ì •ë§ ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆê² ì§€ë§Œ, Keep it simple ì´ë€ ë§ì´ ìˆë“¯ì´ ê°€ì¥ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•´ë³¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤. ì»¨í…ì¸ ê°€ ì„œë¡œ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ë¥¼ ë¹„êµí•´ì„œ ìœ ì‚¬ë„ê°€ ë†’ì€ ì»¨í…ì¸ ë¥¼ ì¶”ì²œí•´ì£¼ëŠ” ë°©ì‹ì…ë‹ˆë‹¤."><meta property="og:type" content="article"><meta property="og:title" content="django ì¶”ì²œì‹œìŠ¤í…œ ê°€ì¥ ì‰½ê²Œ êµ¬í˜„í•˜ê¸°"><meta property="og:image" content="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-11-18-00.png.webp"><!-- HEAD_svelte-zl2pue_END -->
    </head>
    <body data-sveltekit-preload-data="hover">
        <div style="display: contents">   <div class="app flex flex-col"><div class="bg-white w-full p-4 shrink-0 flex justify-between content-center border-b border-slate-200" data-svelte-h="svelte-i8ektw"><div class="logo"><a href="/" class="font-semibold text-2xl flex flex-nowrap"><span class="tf mr-2">ğŸ¦‰</span> ê°œë°œì ëŠ˜í•œ</a></div> <nav class="flex"><a class="flex items-center py-1 px-2 hover:bg-slate-100 cursor-pointer" href="/about">ì†Œê°œ</a></nav> </div> <main> <article class="container p-4 sm:p-12 mx-auto max-w-3xl bg-white"><div class="content-head"><div class="flex"> <h1 class="text-4xl pb-2 font-semibold"><span class="tf">ğŸ”</span> django ì¶”ì²œì‹œìŠ¤í…œ ê°€ì¥ ì‰½ê²Œ êµ¬í˜„í•˜ê¸°</h1></div> <p class="opacity-50 pb-2">2024-05-13</p></div> <div class="content-container md py-4 svelte-a35t19"><p data-svelte-h="svelte-ivvbql">django ì—ì„œ ì¶”ì²œì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œìš”?</p> <p data-svelte-h="svelte-1cgajqu">ì •ë§ ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆê² ì§€ë§Œ, <code>Keep it simple</code> ì´ë€ ë§ì´ ìˆë“¯ì´ ê°€ì¥ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•´ë³¼ ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì•Œì•„ë´…ì‹œë‹¤.</p> <br> <br> <h2 data-svelte-h="svelte-ltgtq">ì»¨í…ì¸  ìœ ì‚¬ë„ ê¸°ë°˜ ì¶”ì²œì‹œìŠ¤í…œ</h2> <p data-svelte-h="svelte-15x1ig5">ì»¨í…ì¸ ê°€ ì„œë¡œ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ë¥¼ ë¹„êµí•´ì„œ ìœ ì‚¬ë„ê°€ ë†’ì€ ì»¨í…ì¸ ë¥¼ ì¶”ì²œí•´ì£¼ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1hxwnp9">ì»¨í…ì¸ ë¼ë¦¬ ì–¼ë§ˆë‚˜ ìœ ì‚¬í•œì§€ë¥¼ ì•Œë ¤ë©´ ì»¨í…ì¸ ë¥¼ ì¢Œí‘œë¡œ ë³€í™˜í•´ì•¼ í•©ë‹ˆë‹¤.</p> <pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">ì»¨í…ì¸ A =&gt; [8, 15]
ì»¨í…ì¸ B =&gt; [12, 13]
ì»¨í…ì¸ C =&gt; [6, 5]</code><!-- HTML_TAG_END --></pre> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-11-18-00.png.webp" alt="embedding" width="700"></p> <br> <br> <p data-svelte-h="svelte-1k2uyjf">ì¢Œí‘œë¡œ í‘œí˜„ëœ ì»¨í…ì¸  ë¼ë¦¬ëŠ” ì„œë¡œì˜ ê±°ë¦¬ë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-11-22-55.png.webp" width="700"></p> <p data-svelte-h="svelte-nh2ot0">ìœ„ ì˜ˆì‹œëŠ” 2ì°¨ì›ìœ¼ë¡œ í‘œí˜„í–ˆì§€ë§Œ, 3, 4ì°¨ì›â€¦ 1ë§Œì°¨ì›ë„ ë™ì¼í•©ë‹ˆë‹¤.</p> <pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">ì»¨í…ì¸ A =&gt; [81.31231, 15.59872, ... 12.34123]
ì»¨í…ì¸ B =&gt; [12.12314, 13.67893, ... 83.31564]
ì»¨í…ì¸ C =&gt; [461.9872, 5.354166, ... 13.67243]</code><!-- HTML_TAG_END --></pre> <p data-svelte-h="svelte-1aqz690">ì´ëŸ¬í•œ ì»¨í…ì¸ ì˜ ìˆ˜í•™ì  í‘œí˜„ì„ ì„ë² ë”©ì´ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.</p> <br> <br> <h2 data-svelte-h="svelte-1rjd4fb">ì„ë² ë”©</h2> <p data-svelte-h="svelte-17plq9n">í…ìŠ¤íŠ¸, ì´ë¯¸ì§€, ë¹„ë””ì˜¤ ëª¨ë‘ ì„ë² ë”©ìœ¼ë¡œ ë³€í™˜ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1v8wc14">ìœ ì‚¬ë„ë¥¼ ì˜ ë¹„êµí•˜ê¸° ìœ„í•´ì„œëŠ” ë¬¸ì„œê°€ ì ì ˆí•œ AI ëª¨ë¸ì„ í†µí•´ ì„ë² ë”©ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.</p> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-11-43-58.png.webp" width="700"></p> <p data-svelte-h="svelte-dmpajt">ì œê°€ ì¶”ì²œí•˜ëŠ” ì„ë² ë”© ëª¨ë¸ì€ OpenAI ì˜ ìµœì‹  ì„ë² ë”© ëª¨ë¸ì¸ <code>text-embedding-3-small</code> ì…ë‹ˆë‹¤.</p> <br> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-04-00-10-08.png.webp" width="700"></p> <br> <p data-svelte-h="svelte-afxlyh"><code>text-embedding-3-small</code> ì€ í…ìŠ¤íŠ¸ë¥¼ 1,536 ì°¨ì›ì˜ ì„ë² ë”©ìœ¼ë¡œ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.<br>
ë¹„ìš©ë„ ë§¤ìš° ì €ë ´í•˜ê³ , í•œê¸€ì— ëŒ€í•œ ì„ë² ë”© ì„±ëŠ¥ë„ ê½¤ ê´œì°®ìŠµë‹ˆë‹¤. ê°œì¸ì ì¸ ì˜ê²¬ì´ì§€ë§Œ, ì§€ê¸ˆ ê¸°ì¤€ìœ¼ë¡œëŠ” ë” ì¢‹ì€ ì„ë² ë”© ëª¨ë¸ì´ ì—†ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-o0xmnc">í•´ë‹¹ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ”ë° ë“œëŠ” ë¹„ìš©ì€ 1ë°±ë§Œ í† í°ì— 0.02ë‹¬ëŸ¬ ì…ë‹ˆë‹¤.<br>
ëŒ€ëµ ì±… 5 ~ 10ê¶Œì„ í†µì§¸ë¡œ ì„ë² ë”© í•´ë„ 27ì› ì •ë„ ë“œëŠ” ì…ˆì´ë„¤ìš”.</p> <br> <br> <h3 data-svelte-h="svelte-ci2rvm">openai embedding ì‚¬ìš©ë°©ë²•</h3> <p data-svelte-h="svelte-1d7niir">openai ì„ë² ë”© ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë¨¼ì € python íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p> <pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">pip <span class="token function">install</span> openai</code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-qcdceh">ê·¸ë¦¬ê³  ì‹¤ì œ ì‚¬ìš© ë°©ì‹ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token keyword">from</span> openai <span class="token keyword">import</span> OpenAI


client <span class="token operator">=</span> OpenAI<span class="token punctuation">(</span>api_key<span class="token operator">=</span><span class="token string">"sk-proj-blahblahblahblahblahblah"</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">create_embedding</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> client<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
        <span class="token builtin">input</span><span class="token operator">=</span><span class="token punctuation">[</span>text<span class="token punctuation">]</span><span class="token punctuation">,</span>
        model<span class="token operator">=</span><span class="token string">"text-embedding-3-small"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>embedding


embedding1 <span class="token operator">=</span> create_embedding<span class="token punctuation">(</span><span class="token string">"django ëŠ” ê°•ë ¥í•œ python ì›¹í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤."</span><span class="token punctuation">)</span>
embedding2 <span class="token operator">=</span> create_embedding<span class="token punctuation">(</span><span class="token string">"python ì€ ì²˜ìŒ ë°°ìš°ê¸° ì¢‹ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì…ë‹ˆë‹¤."</span><span class="token punctuation">)</span>
embedding3 <span class="token operator">=</span> create_embedding<span class="token punctuation">(</span><span class="token string">"react ì™€ í•¨ê»˜ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œí•˜ê¸°"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>embedding1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>embedding2<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>embedding3<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-1bhz039">ì‹¤í–‰ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.014779764227569103</span><span class="token punctuation">,</span> <span class="token number">0.04431036859750748</span><span class="token punctuation">,</span> <span class="token number">0.006599314045161009</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.03325946256518364</span><span class="token punctuation">,</span> <span class="token number">0.030886657536029816</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.04379631578922272</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">0.0325852669775486</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.01150344405323267</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">0.0028920010663568974</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">]</span></code><!-- HTML_TAG_END --></pre> <br> <br> <h3 data-svelte-h="svelte-112tujb">embedding ê°„ ìœ ì‚¬ë„ ê³„ì‚°</h3> <p data-svelte-h="svelte-9x90kb">ìœ ì‚¬ë„ ê³„ì‚°ì—ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì´ ì‚¬ìš©ë˜ì§€ë§Œ, ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê³„ì‚°í•´ë´…ì‹œë‹¤.</p> <p data-svelte-h="svelte-18q2mn3">scipy ë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•˜ë©´ ì‰½ê²Œ ê³„ì‚°í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token keyword">from</span> scipy <span class="token keyword">import</span> spatial


<span class="token comment"># django ëŠ” ê°•ë ¥í•œ python ì›¹í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. vs python ì€ ì²˜ìŒ ë°°ìš°ê¸° ì¢‹ì€ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ì…ë‹ˆë‹¤.</span>
result1 <span class="token operator">=</span> spatial<span class="token punctuation">.</span>distance<span class="token punctuation">.</span>cosine<span class="token punctuation">(</span>embedding1<span class="token punctuation">,</span> embedding2<span class="token punctuation">)</span>

<span class="token comment"># django ëŠ” ê°•ë ¥í•œ python ì›¹í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. vs react ì™€ í•¨ê»˜ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œí•˜ê¸°</span>
result2 <span class="token operator">=</span> spatial<span class="token punctuation">.</span>distance<span class="token punctuation">.</span>cosine<span class="token punctuation">(</span>embedding1<span class="token punctuation">,</span> embedding3<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>result1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result2<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-145t1b6">ì‹¤í–‰ê²°ê³¼ (ìˆ«ìê°€ 0ì— ê°€ê¹Œìš¸ ìˆ˜ë¡ ìœ ì‚¬í•¨)</p> <pre class="language-undefined"><!-- HTML_TAG_START --><code class="language-undefined">0.5632394123335309
0.7933444694105125</code><!-- HTML_TAG_END --></pre> <br> <br> <h2 data-svelte-h="svelte-1u4a3mn">ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤</h2> <p data-svelte-h="svelte-9egeuw">ìœ ì‚¬ë„ ë¹„êµë¥¼ ìœ„í•´ ëª¨ë“  ì»¨í…ì¸ ë¥¼ ë§¤ë²ˆ ìƒˆë¡œ ì„ë² ë”©í•  í•„ìš”ëŠ” ì—†ìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1tjzlal">ëŒ€ì‹  ì»¨í…ì¸ ë¥¼ ë¯¸ë¦¬ ì„ë² ë”©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•´ë‘ê³ , í•„ìš”í•  ë•Œ êº¼ë‚´ì„œ ê³„ì‚°í•˜ë©´ ë©ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1ktvygi">ì´ëŸ¬í•œ ì €ì¥ì„ ì „ë¬¸ì ìœ¼ë¡œ í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë²¡í„° ìŠ¤í† ì–´, í˜¹ì€ ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.</p> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-12-21-21.png.webp" width="700"></p> <br> <p data-svelte-h="svelte-xfljoo">Pinecone, Chroma, FAISS ë“± ì—¬ëŸ¬ê°€ì§€ ì˜µì…˜ì´ ì¡´ì¬í•˜ì§€ë§Œ, django ì—ì„œ ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ ì—­ì‹œ Postgres ì¼ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1s33yft">ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë³„ë„ë¡œ ìš´ìš©í•˜ëŠ” ê²ƒì€ ì‹œìŠ¤í…œ ë³µì¡ë„ë¥¼ í•„ìš” ì´ìƒìœ¼ë¡œ ëŠ˜ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1kz3swn">Postgres ëŠ” ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤ë¡œì„œ ë™ì‘í•˜ë©´ì„œ, ë™ì‹œì— ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ì˜ ì—­í• ì„ í›Œë¥­í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-12-26-49.png.webp" width="700"></p> <br> <br> <h3 data-svelte-h="svelte-98ryae">pgvector</h3> <p data-svelte-h="svelte-1ewnyf9">Postgres ê°€ ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤ì˜ ì—­í• ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” pgvector ë¼ëŠ” Postgres í™•ì¥ì„ ì„¤ì¹˜í•´ì•¼í•©ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-hnkule">ì•„ë˜ pgvector github ì—ì„œ ë³¸ì¸ì˜ í™˜ê²½ì— ë§ëŠ” ë°©ì‹ìœ¼ë¡œ pgvector ë¥¼ ì„¤ì¹˜í•´ì¤ë‹ˆë‹¤.
<a href="https://github.com/pgvector/pgvector" rel="nofollow">https://github.com/pgvector/pgvector</a></p> <p data-svelte-h="svelte-1rzr4o0">window, mac, linux, docker ë“±ì˜ í™˜ê²½ì„ ì§€ì›í•©ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-t3f8hb">ì €ëŠ” mac í™˜ê²½ì—ì„œ <code>brew</code> ë¥¼ í†µí•´ ì„¤ì¹˜í•˜ì˜€ìŠµë‹ˆë‹¤.</p> <pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">brew <span class="token function">install</span> pgvector</code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-uvsp1f">ì„¤ì¹˜ ì´í›„ì— ì•„ë˜ì™€ ê°™ì€ ëª…ë ¹ì–´ë¥¼ psql ì—ì„œ ì…ë ¥í•´ì£¼ë©´ pgvector í™•ì¥ì´ í™œì„±í™”ë©ë‹ˆë‹¤.</p> <pre class="language-sql"><!-- HTML_TAG_START --><code class="language-sql"><span class="token keyword">CREATE</span> EXTENSION vector<span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre> <br> <br> <h2 data-svelte-h="svelte-109ew1z">django pgvector</h2> <p data-svelte-h="svelte-rs6me8">Postgres ì— pgvector ë¥¼ ì¶”ê°€í–ˆìœ¼ë©´ ì´ì œ django ì—ì„œ í™œìš©í•  ì°¨ë¡€ì…ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1cghl0q">python ì˜ pgvector ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ django ì˜ ëª¨ë¸ì— VectorField ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-04-00-12-19.png.webp" alt="pgvector python" width="700"></p> <p data-svelte-h="svelte-1nluanl">ë¨¼ì € pgvector python íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p> <pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">pip <span class="token function">install</span> pgvector</code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-1ge9x2r">django ORM ì„ ê·¸ëŒ€ë¡œ í™œìš©í•´ì„œ ì„ë² ë”©ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ì •ë§ í° ì¥ì ìœ¼ë¡œ ì‘ìš©í•©ë‹ˆë‹¤.</p> <p data-svelte-h="svelte-nqun83">ì‚¬ìš© ë°©ë²•ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p> <br> <p data-svelte-h="svelte-pqs2g">ë¹ˆ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ë§Œë“¤ì–´ì£¼ê³ ,</p> <pre class="language-shell"><!-- HTML_TAG_START --><code class="language-shell">python manage.py makemigrations items <span class="token parameter variable">--empty</span></code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-1ci389q">ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ì•ˆì— ë²¡í„° í™•ì¥ì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ì½”ë“œë¥¼ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ì¤ë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token keyword">from</span> pgvector<span class="token punctuation">.</span>django <span class="token keyword">import</span> VectorExtension

<span class="token keyword">class</span> <span class="token class-name">Migration</span><span class="token punctuation">(</span>migrations<span class="token punctuation">.</span>Migration<span class="token punctuation">)</span><span class="token punctuation">:</span>
    operations <span class="token operator">=</span> <span class="token punctuation">[</span>
        VectorExtension<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span></code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-19st96e">ê·¸ë¦¬ê³  ì„ë² ë”©ì„ ì €ì¥í•  í•„ë“œë¥¼ ëª¨ë¸ì— ì¶”ê°€í•´ì£¼ê¸°ë§Œ í•˜ë©´ ì¤€ë¹„ëŠ” ëë‚©ë‹ˆë‹¤.<br>
ì´ì œ ì„ë² ë”©ì„ Postgres ì— ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token comment"># models.py</span>
<span class="token keyword">from</span> pgvector<span class="token punctuation">.</span>django <span class="token keyword">import</span> VectorField

<span class="token keyword">class</span> <span class="token class-name">Item</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># openaiì˜ text-embedding-3-small ëª¨ë¸ì— ë§ê²Œ 1,536 ì°¨ì›ìœ¼ë¡œ ì„¤ì •</span>
    embedding <span class="token operator">=</span> VectorField<span class="token punctuation">(</span>dimensions<span class="token operator">=</span><span class="token number">1536</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <br> <h3 data-svelte-h="svelte-xvgd38">django pgvector ìœ ì‚¬ë„ ì •ë ¬</h3> <p data-svelte-h="svelte-ooe5ge">ì„ë² ë”© ì´í›„ì— ìœ ì‚¬ë„ ê¸°ì¤€ ì •ë ¬ì„ í•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <p data-svelte-h="svelte-1xqjqow">ë¨¼ì € embedding ì„ ì¶”ê°€í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token comment"># models.py</span>
<span class="token keyword">from</span> openai <span class="token keyword">import</span> OpenAI
<span class="token keyword">from</span> pgvector<span class="token punctuation">.</span>django <span class="token keyword">import</span> VectorField


client <span class="token operator">=</span> OpenAI<span class="token punctuation">(</span>api_key<span class="token operator">=</span><span class="token string">"sk-proj-blahblahblahblahblahblah"</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Item</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">255</span><span class="token punctuation">)</span>
    content <span class="token operator">=</span> models<span class="token punctuation">.</span>TextField<span class="token punctuation">(</span><span class="token punctuation">)</span>
    embedding <span class="token operator">=</span> VectorField<span class="token punctuation">(</span>dimensions<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">create_embedding</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> client<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
            <span class="token builtin">input</span><span class="token operator">=</span><span class="token punctuation">[</span>self<span class="token punctuation">.</span>title<span class="token punctuation">,</span> self<span class="token punctuation">.</span>content<span class="token punctuation">]</span><span class="token punctuation">,</span>
            model<span class="token operator">=</span><span class="token string">"text-embedding-3-small"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>embedding

    <span class="token keyword">def</span> <span class="token function">save</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># ëª¨ë¸ì´ DB ì— ì €ì¥ë  ë•Œ ë§ˆë‹¤ title ê³¼ content ë¡œ ì„ë² ë”© ìƒì„±</span>
        self<span class="token punctuation">.</span>embedding <span class="token operator">=</span> self<span class="token punctuation">.</span>create_embedding<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token operator">*</span>arg<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-1ktxy8f">item object ë¥¼ ìƒì„±í•´ì¤ë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python">Item<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
    title<span class="token operator">=</span><span class="token string">"ê°¤ëŸ­ì‹œ S22 Ultra 128gb Aê¸‰ íŒë‹ˆë‹¤"</span><span class="token punctuation">,</span>
    content<span class="token operator">=</span><span class="token string">"ë°°í„°ë¦¬ ì„±ëŠ¥ 77%ì´ì§€ë§Œ ë°°í„°ë¦¬ êµì²´í•˜ì…”ì„œ ì‚¬ìš©í•˜ì‹œëŠ”ê²Œ ì¢‹ì„ ë“¯ í•©ë‹ˆë‹¤"</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
Item<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
    title<span class="token operator">=</span><span class="token string">"ê°¤ëŸ­ì‹œ Zí”Œë¦½3 ë¸”ë™"</span><span class="token punctuation">,</span>
    content<span class="token operator">=</span><span class="token string">"íˆ¬ëª…ì¼€ì´ìŠ¤ í¬í•¨. ìƒí™œê¸°ìŠ¤ ì¡°ê¸ˆ ìˆëŠ” sê¸‰"</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
Item<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
    title<span class="token operator">=</span><span class="token string">"ìºë…¼ ë Œì¦ˆ EF 50mm íŒë‹ˆë‹¤"</span><span class="token punctuation">,</span>
    content<span class="token operator">=</span><span class="token string">"ë Œì¦ˆ ë§ì— ë…¹ ì—†ìœ¼ë©° ì‚¬ìš©ê° ìˆì§€ë§Œ ì„±ëŠ¥ì—ëŠ” ë¬¸ì œ ì—†ìŠµë‹ˆë‹¤."</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
Item<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
    title<span class="token operator">=</span><span class="token string">"ì†Œë‹ˆ ì¹´ë©”ë¼ zv-1f íŒë§¤í•©ë‹ˆë‹¤"</span><span class="token punctuation">,</span>
    content<span class="token operator">=</span><span class="token string">"ì¹´ë©”ë¼ + ìŠˆíŒ…ê·¸ë¦½ + ì—¬ì¹œë Œì¦ˆ. ì¶©ì „ê¸° í¬í•¨ì…ë‹ˆë‹¤"</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <br> <p data-svelte-h="svelte-168viwi">ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ê°™ì€ ë°©ë²•ìœ¼ë¡œ import í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p> <pre class="language-python"><!-- HTML_TAG_START --><code class="language-python"><span class="token keyword">from</span> pgvector<span class="token punctuation">.</span>django <span class="token keyword">import</span> CosineDistance


<span class="token keyword">def</span> <span class="token function">my_view</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> item_pk<span class="token punctuation">)</span><span class="token punctuation">:</span>
    my_item <span class="token operator">=</span> Item<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>item_pk<span class="token punctuation">)</span>

    distance <span class="token operator">=</span> CosineDistance<span class="token punctuation">(</span><span class="token string">'embedding'</span><span class="token punctuation">,</span> my_item<span class="token punctuation">.</span>embedding<span class="token punctuation">)</span>
    recommendations <span class="token operator">=</span> Item<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>exclude<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span>item_pk<span class="token punctuation">)</span><span class="token punctuation">.</span>order_by<span class="token punctuation">(</span>distance<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>

    context <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">"recommendations"</span><span class="token punctuation">:</span> recommendations
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"item_detail.html"</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre> <br> <p><img src="https://neulhan-blog.s3.ap-northeast-2.amazonaws.com/images/2024-05-13-16-32-27.png.webp" width="700"></p> <p data-svelte-h="svelte-5jqsw7">ì´ë ‡ê²Œ ê°„ë‹¨í•˜ê²Œ django ì— ì¶”ì²œì‹œìŠ¤í…œì„ êµ¬í˜„í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p> <br> <br> </div> <hr> <div class="flex justify-between flex-col sm:flex-row sm:content-start" data-svelte-h="svelte-s1ma3t"><a href="javascript:window.history.back();"><span class="tf">ğŸ‘ˆ</span> ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a> <div class="sm:mt-0 mt-2 relative"><span class="tf pointer-events-none">ğŸ˜</span> ì½ì–´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤</div></div> <hr> <div data-svelte-h="svelte-ofcyfb"><script src="https://giscus.app/client.js" data-repo="Neulhan/Neulhan" data-repo-id="MDEwOlJlcG9zaXRvcnkyODc0NzE2OTA=" data-category="Announcements" data-category-id="DIC_kwDOESJ4Ss4CeXnk" data-mapping="title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="ko" data-loading="lazy" crossorigin="anonymous" async></script></div></article></main> </div> 
			
			<script>
				{
					__sveltekit_1dc3f4i = {
						base: new URL("..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":null,"uses":{},"slash":"always"}];

					Promise.all([
						import("../_app/immutable/entry/start.21561554.js"),
						import("../_app/immutable/entry/app.38abf126.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
    </body>
</html>
